
# DC Motor
1. [20251002，STM32电机控制入门](https://chatgpt.com/c/68de677f-7460-832b-b206-b54819b31206)
2. 后续PID设定，需要”简单的 PWM 扫描测试函数“![[Pasted image 20251002203418.png]]


	1. 完全有作用 ✅，尤其是你现在在做 **电机库封装 + 未来 PID 控制**，这个 PWM 扫描函数不是随便测试，它有几个核心作用：
	## 1️⃣ 找出最小起动 PWM
	
	- 电机有**起动电压 / 起动电流门槛**
    
	- 如果 PWM 太低，电机不转或者微弱抖动
    
	- 扫描可以帮你**精确找到 DeadZone 的合理值**
    
	- 这样库里 DeadZone 就不会写死，也能适配不同电机或负载
	## 2️⃣ 了解电机线性转速范围
	
	- 扫描过程中，你会看到：
    
    - PWM 低 → 电机慢
        
    - PWM 高 → 电机快
        
	- 可以记录下 **PWM 值 vs 速度** 的大致关系
    
	- 对 PID 调速来说，这是非常关键的参考数据（后续速度控制或闭环控制）
	## 3️⃣ 检测硬件极限
	
	- 扫描可以帮你判断：
    
    - 最大 PWM 对应电机的最大速度/最大电流
        
    - 电机是否在高占空比下过热或异常震动
        
	- 避免直接用 100% PWM 就让电机过载
	## 4️⃣ 验证电机库逻辑
	- Motor_SetSpeed() 函数库封装了：
    
    - 方向切换
        
    - PWM 占空比计算
        
    - DeadZone 处理
        
    - 停止模式（刹车 / 悬空）
        
	- 通过 PWM 扫描，可以直观观察：
    
    - 方向切换是否正确
        
    - PWM 输出是否线性
        
    - 电机停止时是否刹车正常
	## 总结
	
	- **核心目标**：把电机从“完全不转”到“满速”的 PWM 范围摸清楚
	
	- **后续好处**：
    
    1. 调整 DeadZone 和 MaxSpeed，让库适配不同电机
        
    2. 为 PID 控制提供线性速度范围
        
	3. 发现电机负载、电源等问题
	换句话说，这个 PWM 扫描函数就像是 **给电机做体检和标定**，是 PID 或闭环控制前的必备工作。
	
	如果你愿意，我可以帮你写 **PWM → 实际速度的映射记录版本**，直接生成一个表格，PID 调速时直接查表即可。
	
	你希望我写吗？


---

# 进行整合
1. 电机库（已成功实现）+编码器+串口回传+Freertos
	1. 不依靠系统的话，太麻烦了
	2. 初步体会到，f103的资源短缺。比如定时器（freertos时钟源用一个+串口用一个+输出pwm用一个），f103仅仅4个定时器；
	3. 虽然定时器内各通道可独立更改pulse，但是基准已由fcs,srr,ccr决定